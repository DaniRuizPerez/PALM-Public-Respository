from bioservices.kegg import KEGG
k = KEGG()


def loadHashTable(filename):
    print("Loading "+filename+"...")
    try:
        file = open(filename, 'r')
    except OSError:
        print( filename + " does not exist")
        return None
    hash = dict()
    for i, line in enumerate(file):
        if (i == 0 or line == "\n" or line == "\r"):
            continue
        key, values = line.replace("\n","").replace("\r","").split("$")
        if (values != ""):
            hash[key] = values
        # hash[key] = list(values.split("|"))
        hash[key] = values
        # printLog("a.txt",  str(key) + "$" +  str(values))
    return hash



##### TRANSFORM METAGENOMICS FILE TO SPECIES SPECIFIC GENE ABUNDANCE FILE

import csv
import numpy as np
data = np.array(list(csv.reader(open("Metagenomics.tsv"), delimiter='\t')))
data = data[0:300,:]
header = data[0,:]
dataRowIDs = data[1:,:4]
data = data[1:,4:].astype(float)

import pandas as pd

s = pd.Series(dataRowIDs[:,3])
labels, levels = pd.factorize(s)

#print correspondence
# with pd.option_context('display.max_rows', None, 'display.max_columns', None):  # more options can be specified also
#     print(s)

taxaNumbers = [1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,27,28,29,31,32,34,35,36,38,39,40,41,42,43,48,50,51,52,53,54,55,56,57,58,59,62,64,65,67,68,69,70,71,74,76,79,83,84,85,86,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,112,117,118,119,121,123,124,125,131,141,144,145,147,148,149,150,151,152,153,154,155,156,157,159,161,163,164,165,166,167,168,172,173,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,199,200,204,205,207,208,209,213,222,224,225,226,227,229,230,231,232,236,238,239,241,245,248,250,251,252,253,257,260,265,267,268,269,271,272,274,279,281,320,1,2,3,4,7,8,10,12,13,14,15,17,18,19,20,22,23,24,25,26,27,28,29,32,34,35,37,38,39,40,42,43,45,48,50,51,52,53,54,55,56,57,58,59,61,62,64,65,66,70,71,76,77,79,85,86,88,89,90,91,92,93,94,95,96,98,101,102,103,104,105,106,107,109,110,113,115,117,121,122,123,124,125,129,134,135,138,139,147,148,149,150,151,152,154,155,158,159,161,163,165,166,167,171,172,173,174,175,177,178,179,184,188,189,192,193,194,195,196,199,207,209,213,215,216,225,227,228,232,235,236,238,240,245,248,250,251,252,253,258,260,271,272,273,274,275,278,279,281,282,289,291,294,1,3,4,7,8,10,11,13,14,15,16,17,18,19,20,22,23,24,28,29,34,35,36,37,38,39,40,41,42,43,48,50,51,52,54,56,57,58,59,61,62,65,69,70,76,77,79,80,82,83,84,86,88,90,94,95,96,101,102,103,104,105,106,107,109,110,112,117,118,119,121,123,124,137,147,148,149,150,151,152,153,154,155,161,165,166,169,175,177,178,179,180,181,182,184,193,194,195,196,200,201,205,207,216,224,225,227,231,238,240,243,250,252,258,263,271,272,274,279,284,70,102,103,34,43,48,58,59,60,86,95,102,319,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,28,29,31,32,34,36,38,39,40,41,48,51,52,54,56,57,58,59,63,69,70,71,74,76,77,79,82,86,88,89,90,91,92,93,101,102,103,117,119,123,124,126,131,132,144,145,147,148,149,150,151,152,153,154,156,157,165,166,169,171,174,175,179,182,184,185,186,187,188,189,192,194,195,196,199,200,204,213,215,222,223,224,225,227,231,236,238,241,252,257,258,260,265,267,268,272,274,278,279,282,303,322,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,45,48,49,50,51,52,53,54,55,56,57,58,59,61,62,63,64,65,66,67,68,69,70,71,74,76,77,79,80,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,98,99,101,102,103,104,105,106,107,109,110,112,113,115,117,118,119,121,123,124,126,127,129,131,132,135,138,139,141,144,145,147,148,149,150,151,152,153,154,155,156,157,158,159,161,163,164,165,166,167,168,170,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,198,199,200,203,204,205,207,208,209,213,215,216,222,223,224,225,227,229,230,231,232,235,236,238,239,240,241,243,245,248,249,250,251,252,253,257,258,260,263,265,267,268,269,271,272,273,274,275,278,279,284,285,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,34,35,36,37,38,40,41,42,43,45,48,50,51,52,54,55,57,58,59,60,61,62,63,65,67,68,69,70,74,76,83,85,86,88,89,90,91,92,93,95,99,101,102,103,104,105,106,107,109,110,114,115,117,121,123,126,131,132,141,144,147,148,149,151,152,153,154,155,156,157,158,159,161,163,164,165,166,167,168,170,171,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,199,200,201,203,204,207,209,215,216,222,224,229,231,232,234,236,238,239,245,248,250,251,252,253,257,260,265,267,268,269,271,272,273,274,275,278,279,290,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,34,35,36,37,38,39,40,41,42,43,45,46,48,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,67,68,69,70,71,74,76,79,83,84,85,86,88,89,90,91,92,93,94,96,98,99,100,101,102,104,105,106,107,109,110,111,112,113,114,115,116,117,118,119,121,122,123,124,125,126,129,131,132,134,135,137,138,139,141,144,145,147,148,149,150,152,154,155,156,157,158,159,161,163,164,165,166,167,168,169,170,171,173,175,176,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,198,199,200,203,204,205,207,208,209,210,213,215,216,222,223,224,225,227,229,230,231,232,233,234,235,236,238,239,240,241,245,248,249,250,251,252,253,256,257,258,260,263,265,266,267,268,269,271,272,273,274,275,278,280,282,293,300,302,320,339,1,2,3,5,6,7,8,11,15,17,18,19,21,22,23,24,25,26,28,29,31,34,35,38,40,41,42,43,48,53,54,55,56,57,58,59,61,62,63,65,67,68,69,70,71,74,76,77,79,80,82,83,85,86,88,91,94,95,96,102,103,104,116,118,119,122,123,124,131,135,163,200,208,209,210,215,229,243,267,268,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,45,48,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,70,71,72,74,76,77,79,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,98,99,101,102,103,104,105,106,107,109,110,112,113,115,117,118,119,121,123,124,125,126,129,131,132,135,141,144,148,149,151,152,153,154,155,157,158,159,161,163,164,165,166,167,168,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,197,198,199,200,201,204,205,207,209,210,213,215,216,220,222,224,225,226,227,229,230,231,233,235,236,238,240,241,243,245,248,250,251,252,253,254,257,258,260,265,267,268,269,271,272,273,274,275,278,279,281,282,284,302,303,336,339,0,1,2,26,27,28,29,31,32,34,35,36,38,39,40,41,42,43,45,46,48,50,51,52,53,54,57,58,59,62,63,64,65,68,69,70,71,74,76,83,84,85,86,89,90,91,93,98,101,102,103,104,105,106,107,109,110,111,115,117,121,123,124,126,127,130,131,132,135,137,138,139,141,144,145,151,157,159,163,164,168,170,171,173,174,175,177,179,180,182,184,187,188,189,190,194,195,196,200,210,211,215,222,224,225,229,231,232,233,234,236,238,240,245,248,250,251,252,260,265,267,268,271,272,273,274,275,279,281,293,294,302,48,56,58,69,70,86,95,102,103,117,118,119,124,194,195,196,102,123,131,155,268,1,2,15,17,19,24,25,28,29,34,35,36,37,38,39,40,41,42,43,48,50,51,52,53,54,56,57,58,59,61,62,63,69,70,74,79,83,84,85,86,88,89,93,94,95,96,98,101,102,104,105,106,107,109,110,112,113,114,115,116,117,121,123,124,125,129,135,151,156,157,158,161,163,164,165,166,172,174,175,177,179,180,181,182,184,187,188,189,190,192,195,197,198,199,200,207,208,209,210,213,215,223,225,230,231,232,236,238,239,245,248,250,251,253,265,271,272,274,279,294,309,339,1,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,29,31,34,36,40,41,48,50,51,53,56,62,67,69,70,71,74,76,79,83,88,93,94,95,96,99,101,102,103,109,110,117,123,124,126,131,132,144,147,148,149,150,151,152,153,154,157,166,167,168,179,180,181,182,184,185,186,187,189,194,195,196,199,205,207,211,216,223,224,225,227,241,248,250,253,257,258,260,267,268,269,284,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,34,35,36,37,38,39,40,41,42,43,45,46,48,50,51,52,53,54,55,56,57,58,59,61,62,63,65,67,68,69,70,71,74,76,77,79,82,83,84,85,86,88,89,90,91,92,93,95,96,98,99,101,102,103,104,105,106,107,109,110,112,113,115,117,118,119,121,123,124,125,126,127,129,131,132,138,139,140,141,144,145,147,148,149,150,151,152,153,154,155,156,157,158,159,161,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,198,199,200,204,205,207,209,210,213,215,216,222,223,224,225,227,229,230,231,232,234,235,236,238,240,241,245,248,249,250,251,252,253,257,258,259,260,265,267,268,269,271,272,273,274,275,278,279,281,282,284,303,1,48,58,59,62,69,77,83,84,88,91,96,102,104,111,123,131,284,286,15,17,19,24,25,34,38,40,43,48,56,57,63,83,86,88,95,96,102,124,215,225,1,4,28,29,31,34,36,41,43,48,50,51,56,57,59,62,64,67,70,71,74,83,86,88,89,91,92,93,102,103,107,109,110,117,119,125,131,132,141,147,148,149,150,152,153,154,158,179,180,181,182,184,185,190,204,207,213,215,216,222,224,227,231,240,241,245,265,267,268,269,274,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,45,46,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,74,76,77,79,80,82,83,84,85,86,87,88,89,90,91,92,93,95,96,97,98,99,101,102,103,104,105,106,107,109,110,112,113,114,115,117,118,119,121,123,124,125,126,127,129,131,132,137,138,139,141,144,145,147,148,149,150,151,152,153,154,155,156,157,158,159,161,163,164,165,166,167,168,170,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,198,199,200,201,204,205,207,209,213,215,216,222,223,224,225,227,229,231,232,233,234,236,238,239,240,241,243,245,248,249,250,251,252,253,254,257,258,260,263,265,267,268,269,271,272,273,274,275,278,279,290,316,328,15,17,19,24,25,27,28,29,34,35,36,38,41,48,51,52,54,57,58,59,65,67,68,69,70,71,74,83,84,85,86,88,89,91,93,96,101,102,104,123,124,131,132,161,173,189,207,211,216,222,267,268,269,1,2,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,38,39,40,41,42,43,48,50,51,52,53,54,56,57,58,59,61,62,68,69,70,71,74,76,77,80,82,83,85,86,88,89,90,91,92,93,95,98,101,102,103,104,105,106,107,109,110,117,118,119,121,123,124,126,129,131,138,139,141,147,148,149,150,152,153,154,155,156,157,159,161,163,164,165,166,171,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,194,195,196,199,200,201,205,207,213,215,216,223,224,227,229,230,231,232,233,234,236,238,239,240,241,245,248,249,250,251,252,253,257,258,260,265,267,268,269,271,272,274,275,294,302,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,34,35,37,38,39,40,41,42,43,48,50,51,52,53,54,57,58,59,61,62,65,67,68,69,70,71,74,76,77,79,80,83,85,86,87,88,89,90,91,92,93,96,97,98,99,101,102,103,104,105,106,107,109,110,117,118,119,121,124,126,131,132,141,144,145,147,148,149,150,151,152,153,154,157,158,159,161,164,165,166,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,199,200,201,203,205,207,213,215,216,222,224,225,226,227,231,232,235,236,238,240,241,243,245,248,249,250,251,252,253,257,258,260,265,267,268,271,272,273,274,275,278,279,281,303,313,1,2,27,28,34,35,36,37,38,43,48,54,55,59,61,62,69,70,74,86,88,90,92,93,95,96,101,102,104,105,106,107,112,114,115,116,117,121,123,124,131,138,139,144,151,155,158,163,164,171,179,184,189,192,198,207,209,213,216,223,224,227,231,236,268,275,278,25,37,56,61,63,69,94,102,110,113,116,123,132,155,161,178,197,198,200,208,239,257,291,1,28,31,34,43,48,52,54,55,58,59,60,62,69,72,83,96,102,111,123,205,232,251,7,8,15,17,18,19,22,23,24,34,35,41,48,52,54,55,57,64,68,70,74,76,77,79,82,83,84,85,88,96,102,104,112,123,124,129,156,200,203,209,215,225,230,267,27,34,48,83,96,98,99,102,104,116,123,124,155,169,193,199,289,34,35,48,58,59,102,104,291,1,48,58,59,62,69,83,84,88,91,96,102,111,12,28,29,31,34,41,43,48,52,54,58,59,65,68,69,70,76,83,84,88,91,95,96,101,102,103,117,131,132,147,165,166,185,186,203,224,231,268,15,19,24,27,43,70,88,102,123,155,156,199,230,57,102,1,2,5,6,11,21,23,26,27,28,29,30,31,34,35,36,37,38,39,40,41,43,48,52,53,54,55,56,57,58,59,61,62,63,65,67,68,69,70,71,74,76,83,84,85,86,88,90,92,94,95,96,97,99,101,102,104,112,116,123,124,126,129,131,132,155,156,157,167,169,171,175,187,194,196,199,200,208,209,215,230,238,243,275,282,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,27,31,34,37,41,43,48,53,54,57,58,59,65,67,69,70,71,74,76,77,82,83,84,86,88,89,90,91,95,96,98,101,102,104,116,118,124,131,147,148,149,150,151,152,153,154,155,157,165,166,177,179,180,181,182,184,185,186,187,188,194,196,204,215,222,224,227,231,241,258,265,267,268,269,271,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,34,36,48,56,58,59,63,69,70,71,83,85,96,101,102,103,109,117,124,131,132,141,144,148,149,152,153,154,178,179,180,181,182,184,190,194,195,196,198,205,208,213,224,225,227,232,240,241,258,303,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,27,28,29,31,32,34,35,37,38,41,42,43,45,48,50,51,52,53,54,55,56,57,58,59,60,61,62,63,65,67,68,69,70,71,74,76,77,79,80,82,83,84,85,86,88,89,90,91,92,93,95,96,98,99,101,102,103,104,105,106,107,110,112,115,117,118,119,121,124,125,126,129,131,132,137,141,144,145,147,148,149,150,151,152,153,154,157,159,161,163,164,165,166,167,168,171,173,174,175,176,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,198,204,205,207,213,215,216,222,224,225,227,231,232,236,238,241,245,248,250,251,252,257,258,260,263,265,267,268,269,271,272,273,274,275,278,284,320,328,27,28,29,38,48,59,67,70,76,77,82,102,104,116,124,132,155,169,181,1,3,4,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,28,34,36,38,39,40,41,48,50,52,56,62,67,69,70,71,83,84,86,88,90,94,95,96,99,101,102,103,110,112,117,123,124,148,149,152,153,154,155,161,167,168,169,178,179,180,181,182,184,194,195,196,199,201,205,207,216,224,225,227,241,250,263,320,34,48,83,96,98,99,102,123,169,193,199,289,1,2,3,4,5,6,7,8,10,12,13,14,15,16,17,18,19,20,21,22,23,24,28,29,30,31,32,34,35,38,40,41,42,43,45,46,48,50,51,52,53,54,55,56,57,58,59,60,62,63,67,68,69,70,71,74,76,77,79,82,83,84,88,89,90,92,93,95,96,98,101,102,103,104,106,107,109,110,112,113,115,117,118,119,121,123,124,126,131,132,141,144,145,147,148,149,150,151,152,153,154,155,157,158,159,161,163,164,165,166,167,168,169,170,172,173,174,175,177,178,179,180,181,182,184,185,186,187,188,189,190,192,194,195,196,198,204,207,209,213,215,222,223,225,227,231,232,236,238,240,241,245,248,250,251,252,253,257,258,260,265,266,267,268,269,271,274,280,281,1,2,27,28,29,35,36,37,38,48,54,55,59,61,62,69,70,74,86,88,90,92,93,96,101,102,104,105,106,107,112,114,115,116,117,121,123,124,131,135,138,139,144,151,155,158,163,164,171,179,184,189,192,198,207,209,213,216,223,224,231,236,268,275,278,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,27,31,34,37,41,43,48,53,54,57,58,59,65,67,69,70,71,74,76,77,82,83,84,86,88,89,90,91,95,96,98,101,102,104,116,118,124,131,147,148,149,150,151,152,153,154,155,157,165,166,177,179,180,181,182,184,185,186,187,188,194,196,204,215,222,224,227,231,241,258,265,267,268,269,271,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,27,28,29,31,32,34,35,36,37,38,40,41,43,45,48,51,53,54,55,57,58,59,62,63,65,67,68,69,70,71,74,76,77,79,82,83,84,85,86,88,89,90,91,95,96,98,99,101,102,107,111,112,113,117,118,119,123,124,125,131,147,148,149,150,151,152,153,154,157,161,165,166,168,171,174,175,177,179,180,181,182,184,185,186,187,188,189,192,193,194,195,196,198,204,205,207,215,216,222,224,227,231,235,238,241,251,252,257,258,265,267,268,269,271,272,273,274,278,279,102,1,2,3,4,7,8,10,12,13,14,15,16,17,18,19,20,22,23,24,25,26,27,28,29,32,34,35,36,37,38,39,40,41,42,43,45,48,50,51,52,53,54,55,57,58,59,61,62,63,65,66,67,68,69,70,76,79,83,85,86,90,91,92,93,96,102,104,105,106,107,109,110,112,113,115,117,121,123,126,127,132,141,149,150,155,156,157,158,161,163,164,165,173,175,177,179,180,182,184,187,188,190,192,199,207,209,213,215,216,222,229,231,236,238,240,245,249,250,252,257,260,265,267,268,269,272,274,309,25,27,28,29,36,38,48,51,52,54,58,59,65,67,68,74,85,86,88,89,91,93,96,101,102,132,161,173,189,207,211,216,222,267,268,269,0,1,2,26,27,28,29,31,32,34,35,36,38,39,40,41,42,43,45,46,48,50,51,52,53,54,57,58,59,62,64,68,69,70,71,74,83,84,85,86,89,90,91,93,98,101,102,103,104,105,106,107,109,110,111,115,117,121,123,124,126,127,130,131,132,135,137,138,139,141,144,145,157,159,163,164,168,170,171,173,174,175,177,187,188,189,190,194,195,196,200,210,215,222,224,225,229,231,232,233,234,236,238,240,245,248,250,251,252,260,265,267,268,271,272,273,274,275,279,281,293,294,302,1,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,27,28,31,32,34,35,36,37,38,40,41,42,43,45,46,48,50,52,53,54,55,56,57,58,59,61,62,63,65,67,69,70,71,74,76,77,79,80,82,83,84,85,86,88,89,90,91,92,95,96,98,99,101,102,103,107,110,112,117,118,123,124,127,129,131,137,145,147,148,149,150,151,152,153,154,155,156,157,165,166,167,170,171,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,198,199,200,204,205,213,215,221,222,224,225,226,227,229,230,231,232,235,238,241,251,252,257,258,265,267,268,269,271,272,274,275,278,279,28,29,38,48,88,96,102,135,138,139,1,2,48,58,59,62,67,68,77,88,91,102,104,116,131,132,168,169,200,209,267,268,284,286,27,28,29,38,48,59,67,70,76,77,82,102,104,116,124,132,155,169,181,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,27,31,34,37,41,43,48,53,54,57,58,59,65,67,69,70,71,74,76,77,82,83,84,86,88,89,90,91,95,96,98,101,102,104,116,118,124,131,147,148,149,150,151,152,153,154,155,157,165,166,177,179,180,181,182,184,185,186,187,188,194,196,204,215,222,224,227,231,241,258,265,267,268,269,271,36,69,102,126,302,1,2,28,31,34,35,36,37,39,40,41,43,48,50,56,57,58,59,61,62,64,65,68,69,74,83,85,86,90,93,94,95,96,101,102,103,107,131,132,157,158,171,172,173,174,175,177,187,188,189,204,213,215,222,231,232,234,235,238,245,251,252,260,265,267,268,269,271,273,274,275,278,281,1,2,10,16,20,26,27,28,29,31,32,34,35,38,39,40,41,42,43,48,50,51,52,53,54,58,59,61,62,65,68,69,70,71,73,74,76,83,84,85,86,88,91,92,93,96,102,103,104,105,106,107,109,110,115,121,123,124,126,131,141,144,147,155,157,158,159,161,163,171,173,174,175,177,185,186,187,188,189,190,199,200,207,215,216,222,225,229,230,231,232,233,238,240,245,248,250,251,252,253,260,265,267,268,271,272,274,275,278,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,27,28,29,31,32,34,35,36,37,38,40,41,43,45,48,51,53,54,55,57,58,59,62,63,65,67,68,69,70,71,74,76,77,79,82,83,84,85,86,88,89,90,91,95,96,98,99,101,102,104,107,111,112,113,116,117,118,119,124,125,131,132,147,148,149,150,151,152,153,154,157,161,165,166,168,169,171,174,175,177,179,180,181,182,184,185,186,187,188,189,192,193,194,195,196,198,200,204,205,207,209,215,216,222,224,227,231,235,238,241,251,252,257,258,265,267,268,269,271,272,273,274,278,279,56,90,94,102,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,28,29,31,32,34,35,37,38,41,42,43,45,48,49,50,51,52,53,54,56,57,58,59,61,62,64,65,67,68,69,70,74,76,77,79,82,83,85,88,89,90,91,92,93,98,99,102,103,104,105,106,107,109,110,112,113,117,123,124,129,131,141,144,147,148,149,150,152,154,157,159,161,163,164,165,166,168,173,175,177,179,180,181,182,184,185,187,188,189,190,193,194,195,196,200,205,207,209,210,213,216,222,224,227,231,232,233,236,238,239,240,245,248,250,251,252,257,258,260,267,268,269,271,272,274,279,48,59,96,289,25,28,29,31,34,38,48,52,54,57,58,59,69,71,83,84,86,90,91,95,96,99,102,157,187,215,1,7,15,17,19,24,28,38,39,40,50,52,62,88,90,102,110,123,124,155,161,169,178,201,207,216,225,250,263,43,48,58,59,86,96,48,94,1,2,4,5,6,7,8,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,48,50,51,52,53,54,56,57,61,62,68,69,70,71,74,76,83,85,86,88,89,90,91,92,93,95,101,102,103,104,105,106,107,109,110,117,121,123,124,126,129,131,132,138,139,141,144,147,148,149,150,152,153,154,155,156,157,158,159,161,163,164,165,166,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,194,195,196,199,200,207,215,216,222,223,224,226,227,229,230,231,233,234,236,238,239,240,241,245,248,249,250,252,253,257,260,265,267,268,271,272,274,275,279,303,25,30,34,48,54,57,58,59,60,63,69,70,77,79,82,83,84,96,102,103,123,124,126,132,148,152,153,154,166,1,2,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,27,29,31,34,35,36,37,38,40,41,43,45,48,53,54,55,57,58,59,62,65,67,68,69,70,71,74,76,77,82,83,84,85,86,88,89,90,91,95,96,98,99,101,102,111,112,118,124,131,147,148,149,150,151,152,153,154,157,165,166,177,179,180,181,182,184,185,186,187,188,194,196,204,215,222,224,227,231,241,258,265,267,268,269,271,1,2,28,29,31,34,35,36,37,39,40,41,42,43,48,51,56,57,58,59,61,62,68,69,74,83,84,85,86,90,93,95,96,101,102,103,104,105,106,107,121,131,132,157,158,171,172,173,174,175,177,187,188,200,203,204,207,213,215,222,231,232,234,235,238,240,245,248,250,251,252,253,259,260,265,267,268,269,271,273,274,275,278,339,45,59,86,102,104,127,211,45,59,86,102,104,127,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,27,28,29,31,32,34,35,37,38,39,40,41,42,45,46,48,50,51,52,53,54,55,57,58,59,60,61,62,65,67,69,71,74,76,83,85,86,88,89,90,91,92,93,96,98,102,103,104,105,106,107,110,112,113,121,123,126,127,129,132,141,147,148,149,150,152,153,154,155,156,157,161,163,164,166,169,171,173,174,175,177,179,180,181,182,184,185,186,187,189,190,192,194,195,196,199,200,204,205,207,213,215,216,222,223,224,227,229,230,231,232,233,236,238,240,241,245,248,250,251,252,253,257,260,265,267,268,269,272,273,274,275,278,279,281,102,211,1,38,62,102,123,124,34,48,58,59,86,25,27,28,29,34,36,38,48,51,52,54,58,59,65,67,68,74,85,86,88,89,90,91,93,96,101,102,132,161,173,189,207,211,216,222,267,268,269,303,1,7,15,17,19,24,28,38,39,40,50,52,62,88,90,102,110,123,124,155,161,169,178,201,207,216,225,250,263,15,17,19,24,25,35,41,48,59,83,84,102,104,123,124,102,211,102,1,7,15,17,19,24,28,38,39,40,50,52,62,88,90,102,110,123,124,155,161,169,178,201,207,216,225,250,263,48,94,96,102,48,96,102,48,94,96,102,34,48,58,59,83,45,59,86,104,127]
taxaNumbers = [1,2,3,4,7,8,10,12,13,14,15,17,18,19,20,22,23,24,25,26,27,28,29,32,34,35,37,38,39,40,42,43,45,48,50,51,52,53,54,55,56,57,58,59,61,62,64,65,66,70,71,76,77,79,85,86,88,89,90,91,92,93,94,95,96,98,101,102,103,104,105,106,107,109,110,113,115,117,121,122,123,124,125,129,134,135,138,139,147,148,149,150,151,152,154,155,158,159,161,163,165,166,167,171,172,173,174,175,177,178,179,184,188,189,192,193,194,195,196,199,207,209,213,215,216,225,227,228,232,235,236,238,240,245,248,250,251,252,253,258,260,271,272,273,274,275,278,279,281,282,289,291,294,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,28,29,31,32,34,36,38,39,40,41,48,51,52,54,56,57,58,59,63,69,70,71,74,76,77,79,82,86,88,89,90,91,92,93,101,102,103,117,119,123,124,126,131,132,144,145,147,148,149,150,151,152,153,154,156,157,165,166,169,171,174,175,179,182,184,185,186,187,188,189,192,194,195,196,199,200,204,213,215,222,223,224,225,227,231,236,238,241,252,257,258,260,265,267,268,272,274,278,279,282,303,322,0,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,45,48,49,50,51,52,53,54,55,56,57,58,59,61,62,63,64,65,66,67,68,69,70,71,74,76,77,79,80,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,98,99,101,102,103,104,105,106,107,109,110,112,113,115,117,118,119,121,123,124,126,127,129,131,132,135,138,139,141,144,145,147,148,149,150,151,152,153,154,155,156,157,158,159,161,163,164,165,166,167,168,170,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,198,199,200,203,204,205,207,208,209,213,215,216,222,223,224,225,227,229,230,231,232,235,236,238,239,240,241,243,245,248,249,250,251,252,253,257,258,260,263,265,267,268,269,271,272,273,274,275,278,279,284,285,123,131,155,268,1,4,28,29,31,34,36,41,43,48,50,51,56,57,59,62,64,67,70,71,74,83,86,88,89,91,92,93,102,103,107,109,110,117,119,125,131,132,141,147,148,149,150,152,153,154,158,179,180,181,182,184,185,190,204,207,213,215,216,222,224,227,231,240,241,245,265,267,268,269,274,15,17,19,24,25,27,28,29,34,35,36,38,41,48,51,52,54,57,58,59,65,67,68,69,70,71,74,83,84,85,86,88,89,91,93,96,101,102,104,123,124,131,132,161,173,189,207,211,216,222,267,268,269,1,2,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,38,39,40,41,42,43,48,50,51,52,53,54,56,57,58,59,61,62,68,69,70,71,74,76,77,80,82,83,85,86,88,89,90,91,92,93,95,98,101,102,103,104,105,106,107,109,110,117,118,119,121,123,124,126,129,131,138,139,141,147,148,149,150,152,153,154,155,156,157,159,161,163,164,165,166,171,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,194,195,196,199,200,201,205,207,213,215,216,223,224,227,229,230,231,232,233,234,236,238,239,240,241,245,248,249,250,251,252,253,257,258,260,265,267,268,269,271,272,274,275,294,302,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,31,32,34,35,37,38,39,40,41,42,43,48,50,51,52,53,54,57,58,59,61,62,65,67,68,69,70,71,74,76,77,79,80,83,85,86,87,88,89,90,91,92,93,96,97,98,99,101,102,103,104,105,106,107,109,110,117,118,119,121,124,126,131,132,141,144,145,147,148,149,150,151,152,153,154,157,158,159,161,164,165,166,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,193,194,195,196,199,200,201,203,205,207,213,215,216,222,224,225,226,227,231,232,235,236,238,240,241,243,245,248,249,250,251,252,253,257,258,260,265,267,268,271,272,273,274,275,278,279,281,303,313,1,28,31,34,43,48,52,54,55,58,59,60,62,69,72,83,96,102,111,123,205,232,251,1,2,5,6,11,21,23,26,27,28,29,30,31,34,35,36,37,38,39,40,41,43,48,52,53,54,55,56,57,58,59,61,62,63,65,67,68,69,70,71,74,76,83,84,85,86,88,90,92,94,95,96,97,99,101,102,104,112,116,123,124,126,129,131,132,155,156,157,167,169,171,175,187,194,196,199,200,208,209,215,230,238,243,275,282,1,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,27,28,29,31,32,34,35,36,37,38,40,41,43,45,48,51,53,54,55,57,58,59,62,63,65,67,68,69,70,71,74,76,77,79,82,83,84,85,86,88,89,90,91,95,96,98,99,101,102,107,111,112,113,117,118,119,123,124,125,131,147,148,149,150,151,152,153,154,157,161,165,166,168,171,174,175,177,179,180,181,182,184,185,186,187,188,189,192,193,194,195,196,198,204,205,207,215,216,222,224,227,231,235,238,241,251,252,257,258,265,267,268,269,271,272,273,274,278,279,102,1,2,3,4,7,8,10,12,13,14,15,16,17,18,19,20,22,23,24,25,26,27,28,29,32,34,35,36,37,38,39,40,41,42,43,45,48,50,51,52,53,54,55,57,58,59,61,62,63,65,66,67,68,69,70,76,79,83,85,86,90,91,92,93,96,102,104,105,106,107,109,110,112,113,115,117,121,123,126,127,132,141,149,150,155,156,157,158,161,163,164,165,173,175,177,179,180,182,184,187,188,190,192,199,207,209,213,215,216,222,229,231,236,238,240,245,249,250,252,257,260,265,267,268,269,272,274,309,25,27,28,29,36,38,48,51,52,54,58,59,65,67,68,74,85,86,88,89,91,93,96,101,102,132,161,173,189,207,211,216,222,267,268,269,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,27,31,34,37,41,43,48,53,54,57,58,59,65,67,69,70,71,74,76,77,82,83,84,86,88,89,90,91,95,96,98,101,102,104,116,118,124,131,147,148,149,150,151,152,153,154,155,157,165,166,177,179,180,181,182,184,185,186,187,188,194,196,204,215,222,224,227,231,241,258,265,267,268,269,271,56,90,94,102,25,28,29,31,34,38,48,52,54,57,58,59,69,71,83,84,86,90,91,95,96,99,102,157,187,215,43,48,58,59,86,96,1,2,4,5,6,7,8,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,48,50,51,52,53,54,56,57,61,62,68,69,70,71,74,76,83,85,86,88,89,90,91,92,93,95,101,102,103,104,105,106,107,109,110,117,121,123,124,126,129,131,132,138,139,141,144,147,148,149,150,152,153,154,155,156,157,158,159,161,163,164,165,166,171,172,173,174,175,177,179,180,181,182,184,185,186,187,188,189,190,192,194,195,196,199,200,207,215,216,222,223,224,226,227,229,230,231,233,234,236,238,239,240,241,245,248,249,250,252,253,257,260,265,267,268,271,272,274,275,279,303,102,211,102,211,102]

sDict = s.to_dict()
for taxaNumber in taxaNumbers:
    print(str(taxaNumber) + ":" +  str(sDict.get(taxaNumber)))


#
# #ompute the boundaries of one gene vs the next one
# def computeBoundariesOfGenes(v):
#     boundaries = list()
#     boundaries.append(0)
#     previousName = v[0]
#     for i in range(1,len(v)):
#         if (v[i] == previousName):
#             continue
#         else:
#             previousName = v[i]
#             boundaries.append(i)
#     boundaries.append(len(v))
#     return boundaries
#
# allBoundariesKO = computeBoundariesOfGenes(dataRowIDs[:,1])
#
#
# #Output variable
# output = np.zeros((len(data)*len(data[0]),5))
# outputKO = np.chararray((len(data)*len(data[0])), itemsize=10)
# outputSubjectID = np.chararray((len(data)*len(data[0])), itemsize=10)
# outputOTUID = np.chararray((len(data)*len(data[0])), itemsize=100)
# #Iterate over Samples
# for s in range(0,len(data[0])):
#     print(s)
#     #Add the subject name to the output
#     outputSubjectID[((s)*len(data)):((s+1)*len(data))] =  np.array([header[s+4]]*(((s+1)*len(data))-((s)*len(data))))
#     #Iterate over KO
#     for j in range(0, len(allBoundariesKO)-1):
#         beginK0 = allBoundariesKO[j]
#         endKO = allBoundariesKO[j+1]
#         #Insert KO ID
#         outputKO[(s*len(data)+beginK0):(s*len(data)+endKO)] = dataRowIDs[beginK0:endKO,1]
#         #Insert OTU ID
#         outputOTUID[(s*len(data)+beginK0):(s*len(data)+endKO)] = labels[beginK0:endKO,] #dataRowIDs[beginK0:endKO,3]
#         #Insert counts per genome (all 1s)
#         output[(s*len(data)+beginK0):(s*len(data)+endKO),0] = [1]*(endKO-beginK0)
#         # Insert OTUAbundanceInSample
#         output[(s*len(data)+beginK0):(s*len(data)+endKO), 1] = data[beginK0:endKO, s]
#         output[(s*len(data)+beginK0):(s*len(data)+endKO), 2] = data[beginK0:endKO, s]
#         # Insert ContributionPercentOfSample
#         if (sum(data[beginK0:endKO, s])!=0):
#             output[(s*len(data)+beginK0):(s*len(data)+endKO), 3] = data[beginK0:endKO, s]/sum(data[beginK0:endKO, s])
#         else:
#             data[beginK0:endKO, s]*0
#
#         #missing ContributionPercentOfAllSamples
#         output[(s*len(data)+beginK0):(s*len(data)+endKO), 4] = [1]*(endKO-beginK0)
#
#     # if (s > 2):
#     #     break
#
# print("Saving...")
# with open("SpeciesSpecificGeneAbundanceFilteredJustNetworkSelected.csv", 'w',newline='') as csv_file:
#     writer = csv.writer(csv_file, delimiter='$',quoting=csv.QUOTE_NONE,quotechar='',escapechar='')
#     writer.writerow(["Gene,OTU,GeneCountPerGenome,OTUAbundanceInSample,CountContributedByOTU,ContributionPercentOfSample,ContributionPercentOfAllSamples,Sample"])
#     for i in range(0,len(output)-1):
#
#         a = outputKO[i]
#         b = outputOTUID[i]
#         c = output[i]
#         d = outputSubjectID[i]
#
#
#
#         write =str(outputKO[i], 'utf-8') +","+  str(outputOTUID[i], 'utf-8') + "," + ','.join(map(str,list(output[i,:]))) + "," + str(outputSubjectID[i], 'utf-8')
#         writer.writerow([write])
#
#
#
# # b = [str(x, 'utf-8') for x in a]
#





















